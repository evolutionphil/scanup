{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  // prettier-ignore\n  const MARKERS = [0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc8, 0xffc9, 0xffca, 0xffcb, 0xffcc, 0xffcd, 0xffce, 0xffcf];\n  var ColorSpace;\n  (function (ColorSpace) {\n    ColorSpace[\"DeviceGray\"] = \"DeviceGray\";\n    ColorSpace[\"DeviceRGB\"] = \"DeviceRGB\";\n    ColorSpace[\"DeviceCMYK\"] = \"DeviceCMYK\";\n  })(ColorSpace || (ColorSpace = {}));\n  const ChannelToColorSpace = {\n    1: ColorSpace.DeviceGray,\n    3: ColorSpace.DeviceRGB,\n    4: ColorSpace.DeviceCMYK\n  };\n  /**\n   * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n   * this class borrows from:\n   *   https://github.com/foliojs/pdfkit/blob/a6af76467ce06bd6a2af4aa7271ccac9ff152a7d/lib/image/jpeg.js\n   */\n  class JpegEmbedder {\n    static async for(imageData) {\n      const dataView = new DataView(imageData.buffer);\n      const soi = dataView.getUint16(0);\n      if (soi !== 0xffd8) throw new Error('SOI not found in JPEG');\n      let pos = 2;\n      let marker;\n      while (pos < dataView.byteLength) {\n        marker = dataView.getUint16(pos);\n        pos += 2;\n        if (MARKERS.includes(marker)) break;\n        pos += dataView.getUint16(pos);\n      }\n      if (!MARKERS.includes(marker)) throw new Error('Invalid JPEG');\n      pos += 2;\n      const bitsPerComponent = dataView.getUint8(pos++);\n      const height = dataView.getUint16(pos);\n      pos += 2;\n      const width = dataView.getUint16(pos);\n      pos += 2;\n      const channelByte = dataView.getUint8(pos++);\n      const channelName = ChannelToColorSpace[channelByte];\n      if (!channelName) throw new Error('Unknown JPEG channel.');\n      const colorSpace = channelName;\n      return new JpegEmbedder(imageData, bitsPerComponent, width, height, colorSpace);\n    }\n    constructor(imageData, bitsPerComponent, width, height, colorSpace) {\n      this.imageData = imageData;\n      this.bitsPerComponent = bitsPerComponent;\n      this.width = width;\n      this.height = height;\n      this.colorSpace = colorSpace;\n    }\n    async embedIntoContext(context, ref) {\n      const xObject = context.stream(this.imageData, {\n        Type: 'XObject',\n        Subtype: 'Image',\n        BitsPerComponent: this.bitsPerComponent,\n        Width: this.width,\n        Height: this.height,\n        ColorSpace: this.colorSpace,\n        Filter: 'DCTDecode',\n        // CMYK JPEG streams in PDF are typically stored complemented,\n        // with 1 as 'off' and 0 as 'on' (PDF 32000-1:2008, 8.6.4.4).\n        //\n        // Standalone CMYK JPEG (usually exported by Photoshop) are\n        // stored inverse, with 0 as 'off' and 1 as 'on', like RGB.\n        //\n        // Applying a swap here as a hedge that most bytes passing\n        // through this method will benefit from it.\n        Decode: this.colorSpace === ColorSpace.DeviceCMYK ? [1, 0, 1, 0, 1, 0, 1, 0] : undefined\n      });\n      if (ref) {\n        context.assign(ref, xObject);\n        return ref;\n      } else {\n        return context.register(xObject);\n      }\n    }\n  }\n  var _default = JpegEmbedder;\n});","lineCount":92,"map":[[7,2,92,0,"Object"],[7,8,92,0],[7,9,92,0,"defineProperty"],[7,23,92,0],[7,24,92,0,"exports"],[7,31,92,0],[8,4,92,0,"enumerable"],[8,14,92,0],[9,4,92,0,"get"],[9,7,92,0],[9,18,92,0,"get"],[9,19,92,0],[10,6,92,0],[10,13,92,0,"_default"],[10,21,92,0],[11,4,92,0],[12,2,92,0],[13,2,1,0],[14,2,2,0],[14,8,2,6,"MARKERS"],[14,15,2,13],[14,18,2,16],[14,19,3,4],[14,25,3,10],[14,27,3,12],[14,33,3,18],[14,35,3,20],[14,41,3,26],[14,43,4,4],[14,49,4,10],[14,51,4,12],[14,57,4,18],[14,59,4,20],[14,65,4,26],[14,67,5,4],[14,73,5,10],[14,75,5,12],[14,81,5,18],[14,83,5,20],[14,89,5,26],[14,91,6,4],[14,97,6,10],[14,99,6,12],[14,105,6,18],[14,107,6,20],[14,113,6,26],[14,115,7,4],[14,121,7,10],[14,123,7,12],[14,129,7,18],[14,131,7,20],[14,137,7,26],[14,138,8,1],[15,2,9,0],[15,6,9,4,"ColorSpace"],[15,16,9,14],[16,2,10,0],[16,3,10,1],[16,13,10,11,"ColorSpace"],[16,23,10,21],[16,25,10,23],[17,4,11,4,"ColorSpace"],[17,14,11,14],[17,15,11,15],[17,27,11,27],[17,28,11,28],[17,31,11,31],[17,43,11,43],[18,4,12,4,"ColorSpace"],[18,14,12,14],[18,15,12,15],[18,26,12,26],[18,27,12,27],[18,30,12,30],[18,41,12,41],[19,4,13,4,"ColorSpace"],[19,14,13,14],[19,15,13,15],[19,27,13,27],[19,28,13,28],[19,31,13,31],[19,43,13,43],[20,2,14,0],[20,3,14,1],[20,5,14,3,"ColorSpace"],[20,15,14,13],[20,20,14,18,"ColorSpace"],[20,30,14,28],[20,33,14,31],[20,34,14,32],[20,35,14,33],[20,36,14,34],[20,37,14,35],[21,2,15,0],[21,8,15,6,"ChannelToColorSpace"],[21,27,15,25],[21,30,15,28],[22,4,16,4],[22,5,16,5],[22,7,16,7,"ColorSpace"],[22,17,16,17],[22,18,16,18,"DeviceGray"],[22,28,16,28],[23,4,17,4],[23,5,17,5],[23,7,17,7,"ColorSpace"],[23,17,17,17],[23,18,17,18,"DeviceRGB"],[23,27,17,27],[24,4,18,4],[24,5,18,5],[24,7,18,7,"ColorSpace"],[24,17,18,17],[24,18,18,18,"DeviceCMYK"],[25,2,19,0],[25,3,19,1],[26,2,20,0],[27,0,21,0],[28,0,22,0],[29,0,23,0],[30,0,24,0],[31,2,25,0],[31,8,25,6,"JpegEmbedder"],[31,20,25,18],[31,21,25,19],[32,4,26,4],[32,17,26,17,"for"],[32,20,26,20,"for"],[32,21,26,21,"imageData"],[32,30,26,30],[32,32,26,32],[33,6,27,8],[33,12,27,14,"dataView"],[33,20,27,22],[33,23,27,25],[33,27,27,29,"DataView"],[33,35,27,37],[33,36,27,38,"imageData"],[33,45,27,47],[33,46,27,48,"buffer"],[33,52,27,54],[33,53,27,55],[34,6,28,8],[34,12,28,14,"soi"],[34,15,28,17],[34,18,28,20,"dataView"],[34,26,28,28],[34,27,28,29,"getUint16"],[34,36,28,38],[34,37,28,39],[34,38,28,40],[34,39,28,41],[35,6,29,8],[35,10,29,12,"soi"],[35,13,29,15],[35,18,29,20],[35,24,29,26],[35,26,30,12],[35,32,30,18],[35,36,30,22,"Error"],[35,41,30,27],[35,42,30,28],[35,65,30,51],[35,66,30,52],[36,6,31,8],[36,10,31,12,"pos"],[36,13,31,15],[36,16,31,18],[36,17,31,19],[37,6,32,8],[37,10,32,12,"marker"],[37,16,32,18],[38,6,33,8],[38,13,33,15,"pos"],[38,16,33,18],[38,19,33,21,"dataView"],[38,27,33,29],[38,28,33,30,"byteLength"],[38,38,33,40],[38,40,33,42],[39,8,34,12,"marker"],[39,14,34,18],[39,17,34,21,"dataView"],[39,25,34,29],[39,26,34,30,"getUint16"],[39,35,34,39],[39,36,34,40,"pos"],[39,39,34,43],[39,40,34,44],[40,8,35,12,"pos"],[40,11,35,15],[40,15,35,19],[40,16,35,20],[41,8,36,12],[41,12,36,16,"MARKERS"],[41,19,36,23],[41,20,36,24,"includes"],[41,28,36,32],[41,29,36,33,"marker"],[41,35,36,39],[41,36,36,40],[41,38,37,16],[42,8,38,12,"pos"],[42,11,38,15],[42,15,38,19,"dataView"],[42,23,38,27],[42,24,38,28,"getUint16"],[42,33,38,37],[42,34,38,38,"pos"],[42,37,38,41],[42,38,38,42],[43,6,39,8],[44,6,40,8],[44,10,40,12],[44,11,40,13,"MARKERS"],[44,18,40,20],[44,19,40,21,"includes"],[44,27,40,29],[44,28,40,30,"marker"],[44,34,40,36],[44,35,40,37],[44,37,41,12],[44,43,41,18],[44,47,41,22,"Error"],[44,52,41,27],[44,53,41,28],[44,67,41,42],[44,68,41,43],[45,6,42,8,"pos"],[45,9,42,11],[45,13,42,15],[45,14,42,16],[46,6,43,8],[46,12,43,14,"bitsPerComponent"],[46,28,43,30],[46,31,43,33,"dataView"],[46,39,43,41],[46,40,43,42,"getUint8"],[46,48,43,50],[46,49,43,51,"pos"],[46,52,43,54],[46,54,43,56],[46,55,43,57],[47,6,44,8],[47,12,44,14,"height"],[47,18,44,20],[47,21,44,23,"dataView"],[47,29,44,31],[47,30,44,32,"getUint16"],[47,39,44,41],[47,40,44,42,"pos"],[47,43,44,45],[47,44,44,46],[48,6,45,8,"pos"],[48,9,45,11],[48,13,45,15],[48,14,45,16],[49,6,46,8],[49,12,46,14,"width"],[49,17,46,19],[49,20,46,22,"dataView"],[49,28,46,30],[49,29,46,31,"getUint16"],[49,38,46,40],[49,39,46,41,"pos"],[49,42,46,44],[49,43,46,45],[50,6,47,8,"pos"],[50,9,47,11],[50,13,47,15],[50,14,47,16],[51,6,48,8],[51,12,48,14,"channelByte"],[51,23,48,25],[51,26,48,28,"dataView"],[51,34,48,36],[51,35,48,37,"getUint8"],[51,43,48,45],[51,44,48,46,"pos"],[51,47,48,49],[51,49,48,51],[51,50,48,52],[52,6,49,8],[52,12,49,14,"channelName"],[52,23,49,25],[52,26,49,28,"ChannelToColorSpace"],[52,45,49,47],[52,46,49,48,"channelByte"],[52,57,49,59],[52,58,49,60],[53,6,50,8],[53,10,50,12],[53,11,50,13,"channelName"],[53,22,50,24],[53,24,51,12],[53,30,51,18],[53,34,51,22,"Error"],[53,39,51,27],[53,40,51,28],[53,63,51,51],[53,64,51,52],[54,6,52,8],[54,12,52,14,"colorSpace"],[54,22,52,24],[54,25,52,27,"channelName"],[54,36,52,38],[55,6,53,8],[55,13,53,15],[55,17,53,19,"JpegEmbedder"],[55,29,53,31],[55,30,53,32,"imageData"],[55,39,53,41],[55,41,53,43,"bitsPerComponent"],[55,57,53,59],[55,59,53,61,"width"],[55,64,53,66],[55,66,53,68,"height"],[55,72,53,74],[55,74,53,76,"colorSpace"],[55,84,53,86],[55,85,53,87],[56,4,54,4],[57,4,55,4,"constructor"],[57,15,55,15,"constructor"],[57,16,55,16,"imageData"],[57,25,55,25],[57,27,55,27,"bitsPerComponent"],[57,43,55,43],[57,45,55,45,"width"],[57,50,55,50],[57,52,55,52,"height"],[57,58,55,58],[57,60,55,60,"colorSpace"],[57,70,55,70],[57,72,55,72],[58,6,56,8],[58,10,56,12],[58,11,56,13,"imageData"],[58,20,56,22],[58,23,56,25,"imageData"],[58,32,56,34],[59,6,57,8],[59,10,57,12],[59,11,57,13,"bitsPerComponent"],[59,27,57,29],[59,30,57,32,"bitsPerComponent"],[59,46,57,48],[60,6,58,8],[60,10,58,12],[60,11,58,13,"width"],[60,16,58,18],[60,19,58,21,"width"],[60,24,58,26],[61,6,59,8],[61,10,59,12],[61,11,59,13,"height"],[61,17,59,19],[61,20,59,22,"height"],[61,26,59,28],[62,6,60,8],[62,10,60,12],[62,11,60,13,"colorSpace"],[62,21,60,23],[62,24,60,26,"colorSpace"],[62,34,60,36],[63,4,61,4],[64,4,62,4],[64,10,62,10,"embedIntoContext"],[64,26,62,26,"embedIntoContext"],[64,27,62,27,"context"],[64,34,62,34],[64,36,62,36,"ref"],[64,39,62,39],[64,41,62,41],[65,6,63,8],[65,12,63,14,"xObject"],[65,19,63,21],[65,22,63,24,"context"],[65,29,63,31],[65,30,63,32,"stream"],[65,36,63,38],[65,37,63,39],[65,41,63,43],[65,42,63,44,"imageData"],[65,51,63,53],[65,53,63,55],[66,8,64,12,"Type"],[66,12,64,16],[66,14,64,18],[66,23,64,27],[67,8,65,12,"Subtype"],[67,15,65,19],[67,17,65,21],[67,24,65,28],[68,8,66,12,"BitsPerComponent"],[68,24,66,28],[68,26,66,30],[68,30,66,34],[68,31,66,35,"bitsPerComponent"],[68,47,66,51],[69,8,67,12,"Width"],[69,13,67,17],[69,15,67,19],[69,19,67,23],[69,20,67,24,"width"],[69,25,67,29],[70,8,68,12,"Height"],[70,14,68,18],[70,16,68,20],[70,20,68,24],[70,21,68,25,"height"],[70,27,68,31],[71,8,69,12,"ColorSpace"],[71,18,69,22],[71,20,69,24],[71,24,69,28],[71,25,69,29,"colorSpace"],[71,35,69,39],[72,8,70,12,"Filter"],[72,14,70,18],[72,16,70,20],[72,27,70,31],[73,8,71,12],[74,8,72,12],[75,8,73,12],[76,8,74,12],[77,8,75,12],[78,8,76,12],[79,8,77,12],[80,8,78,12],[81,8,79,12,"Decode"],[81,14,79,18],[81,16,79,20],[81,20,79,24],[81,21,79,25,"colorSpace"],[81,31,79,35],[81,36,79,40,"ColorSpace"],[81,46,79,50],[81,47,79,51,"DeviceCMYK"],[81,57,79,61],[81,60,80,18],[81,61,80,19],[81,62,80,20],[81,64,80,22],[81,65,80,23],[81,67,80,25],[81,68,80,26],[81,70,80,28],[81,71,80,29],[81,73,80,31],[81,74,80,32],[81,76,80,34],[81,77,80,35],[81,79,80,37],[81,80,80,38],[81,82,80,40],[81,83,80,41],[81,84,80,42],[81,87,81,18,"undefined"],[82,6,82,8],[82,7,82,9],[82,8,82,10],[83,6,83,8],[83,10,83,12,"ref"],[83,13,83,15],[83,15,83,17],[84,8,84,12,"context"],[84,15,84,19],[84,16,84,20,"assign"],[84,22,84,26],[84,23,84,27,"ref"],[84,26,84,30],[84,28,84,32,"xObject"],[84,35,84,39],[84,36,84,40],[85,8,85,12],[85,15,85,19,"ref"],[85,18,85,22],[86,6,86,8],[86,7,86,9],[86,13,87,13],[87,8,88,12],[87,15,88,19,"context"],[87,22,88,26],[87,23,88,27,"register"],[87,31,88,35],[87,32,88,36,"xObject"],[87,39,88,43],[87,40,88,44],[88,6,89,8],[89,4,90,4],[90,2,91,0],[91,2,92,0],[91,6,92,0,"_default"],[91,14,92,0],[91,17,92,15,"JpegEmbedder"],[91,29,92,27],[92,0,92,28],[92,3]],"functionMap":{"names":["<global>","<anonymous>","JpegEmbedder","_for","constructor","embedIntoContext"],"mappings":"AAA;CCS;CDI;AEW;ICC;KD4B;IEC;KFM;IGC;KH4B;CFC"},"hasCjsExports":false},"type":"js/module"}]}