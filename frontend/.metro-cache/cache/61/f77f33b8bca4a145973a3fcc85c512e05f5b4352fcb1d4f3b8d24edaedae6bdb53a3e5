{"dependencies":[{"name":"../types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":89},"end":{"line":7,"column":40,"index":129}}],"key":"8cLkkKYebhz8179+ortY3/pylDg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  /**\n   * Error utilities for parsing platform-specific error responses\n   */\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.parseErrorStringToJsonObj = parseErrorStringToJsonObj;\n  exports.isUserCancelledError = isUserCancelledError;\n  var _typesJs = require(_dependencyMap[0], \"../types.js\");\n  /**\n   * Parses error string from native modules into a structured error object\n   *\n   * Native modules return errors in different formats:\n   * - Android: JSON string like '{\"code\":\"E_USER_CANCELLED\",\"message\":\"User cancelled the purchase\",\"responseCode\":1}'\n   * - iOS: JSON string or plain message\n   * - Legacy: \"CODE: message\" format\n   *\n   * @param errorString - The error string from native module\n   * @returns Parsed error object with code and message\n   */\n  function parseErrorStringToJsonObj(errorString) {\n    // Handle Error objects\n    if (errorString instanceof Error) {\n      errorString = errorString.message;\n    }\n\n    // Handle non-string inputs\n    if (typeof errorString !== 'string') {\n      return {\n        code: _typesJs.ErrorCode.Unknown,\n        message: 'Unknown error occurred'\n      };\n    }\n\n    // Try to parse as JSON first\n    try {\n      const parsed = JSON.parse(errorString);\n      if (typeof parsed === 'object' && parsed !== null) {\n        // Ensure it has at least code and message\n        return Object.assign({\n          code: parsed.code || _typesJs.ErrorCode.Unknown,\n          message: parsed.message || errorString\n        }, parsed);\n      }\n    } catch {\n      // Not JSON, continue with other formats\n    }\n\n    // Try to parse \"CODE: message\" format\n    const colonIndex = errorString.indexOf(':');\n    if (colonIndex > 0 && colonIndex < 50) {\n      // Reasonable position for error code\n      const potentialCode = errorString.substring(0, colonIndex).trim();\n      // Check if it looks like an error code (starts with E_ or contains uppercase)\n      if (potentialCode.startsWith('E_') || /^[A-Z_]+$/.test(potentialCode)) {\n        return {\n          code: potentialCode,\n          message: errorString.substring(colonIndex + 1).trim()\n        };\n      }\n    }\n\n    // Fallback: treat entire string as message\n    return {\n      code: _typesJs.ErrorCode.Unknown,\n      message: errorString\n    };\n  }\n\n  /**\n   * Checks if an error code indicates user cancellation\n   * @param error - Error object or string\n   * @returns true if the error is a user cancellation\n   */\n  function isUserCancelledError(error) {\n    const errorObj = typeof error === 'object' && error !== null && 'code' in error ? error : parseErrorStringToJsonObj(error);\n    return errorObj.code === _typesJs.ErrorCode.UserCancelled || errorObj.code === 'E_USER_CANCELED' ||\n    // Alternative spelling\n    errorObj.responseCode === 1; // Android BillingClient.BillingResponseCode.USER_CANCELED\n  }\n});","lineCount":84,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[5,0,4,0],[6,0,5,0],[7,2,3,0,"Object"],[7,8,3,0],[7,9,3,0,"defineProperty"],[7,23,3,0],[7,24,3,0,"exports"],[7,31,3,0],[8,4,3,0,"value"],[8,9,3,0],[9,2,3,0],[10,2,19,0,"exports"],[10,9,19,0],[10,10,19,0,"parseErrorStringToJsonObj"],[10,35,19,0],[10,38,19,0,"parseErrorStringToJsonObj"],[10,63,19,0],[11,2,74,0,"exports"],[11,9,74,0],[11,10,74,0,"isUserCancelledError"],[11,30,74,0],[11,33,74,0,"isUserCancelledError"],[11,53,74,0],[12,2,7,0],[12,6,7,0,"_typesJs"],[12,14,7,0],[12,17,7,0,"require"],[12,24,7,0],[12,25,7,0,"_dependencyMap"],[12,39,7,0],[13,2,8,0],[14,0,9,0],[15,0,10,0],[16,0,11,0],[17,0,12,0],[18,0,13,0],[19,0,14,0],[20,0,15,0],[21,0,16,0],[22,0,17,0],[23,0,18,0],[24,2,19,7],[24,11,19,16,"parseErrorStringToJsonObj"],[24,36,19,41,"parseErrorStringToJsonObj"],[24,37,19,42,"errorString"],[24,48,19,53],[24,50,19,55],[25,4,20,2],[26,4,21,2],[26,8,21,6,"errorString"],[26,19,21,17],[26,31,21,29,"Error"],[26,36,21,34],[26,38,21,36],[27,6,22,4,"errorString"],[27,17,22,15],[27,20,22,18,"errorString"],[27,31,22,29],[27,32,22,30,"message"],[27,39,22,37],[28,4,23,2],[30,4,25,2],[31,4,26,2],[31,8,26,6],[31,15,26,13,"errorString"],[31,26,26,24],[31,31,26,29],[31,39,26,37],[31,41,26,39],[32,6,27,4],[32,13,27,11],[33,8,28,6,"code"],[33,12,28,10],[33,14,28,12,"ErrorCode"],[33,22,28,21],[33,23,28,21,"ErrorCode"],[33,32,28,21],[33,33,28,22,"Unknown"],[33,40,28,29],[34,8,29,6,"message"],[34,15,29,13],[34,17,29,15],[35,6,30,4],[35,7,30,5],[36,4,31,2],[38,4,33,2],[39,4,34,2],[39,8,34,6],[40,6,35,4],[40,12,35,10,"parsed"],[40,18,35,16],[40,21,35,19,"JSON"],[40,25,35,23],[40,26,35,24,"parse"],[40,31,35,29],[40,32,35,30,"errorString"],[40,43,35,41],[40,44,35,42],[41,6,36,4],[41,10,36,8],[41,17,36,15,"parsed"],[41,23,36,21],[41,28,36,26],[41,36,36,34],[41,40,36,38,"parsed"],[41,46,36,44],[41,51,36,49],[41,55,36,53],[41,57,36,55],[42,8,37,6],[43,8,38,6],[43,15,38,6,"Object"],[43,21,38,6],[43,22,38,6,"assign"],[43,28,38,6],[44,10,39,8,"code"],[44,14,39,12],[44,16,39,14,"parsed"],[44,22,39,20],[44,23,39,21,"code"],[44,27,39,25],[44,31,39,29,"ErrorCode"],[44,39,39,38],[44,40,39,38,"ErrorCode"],[44,49,39,38],[44,50,39,39,"Unknown"],[44,57,39,46],[45,10,40,8,"message"],[45,17,40,15],[45,19,40,17,"parsed"],[45,25,40,23],[45,26,40,24,"message"],[45,33,40,31],[45,37,40,35,"errorString"],[46,8,40,46],[46,11,41,11,"parsed"],[46,17,41,17],[47,6,43,4],[48,4,44,2],[48,5,44,3],[48,6,44,4],[48,12,44,10],[49,6,45,4],[50,4,45,4],[52,4,48,2],[53,4,49,2],[53,10,49,8,"colonIndex"],[53,20,49,18],[53,23,49,21,"errorString"],[53,34,49,32],[53,35,49,33,"indexOf"],[53,42,49,40],[53,43,49,41],[53,46,49,44],[53,47,49,45],[54,4,50,2],[54,8,50,6,"colonIndex"],[54,18,50,16],[54,21,50,19],[54,22,50,20],[54,26,50,24,"colonIndex"],[54,36,50,34],[54,39,50,37],[54,41,50,39],[54,43,50,41],[55,6,51,4],[56,6,52,4],[56,12,52,10,"potentialCode"],[56,25,52,23],[56,28,52,26,"errorString"],[56,39,52,37],[56,40,52,38,"substring"],[56,49,52,47],[56,50,52,48],[56,51,52,49],[56,53,52,51,"colonIndex"],[56,63,52,61],[56,64,52,62],[56,65,52,63,"trim"],[56,69,52,67],[56,70,52,68],[56,71,52,69],[57,6,53,4],[58,6,54,4],[58,10,54,8,"potentialCode"],[58,23,54,21],[58,24,54,22,"startsWith"],[58,34,54,32],[58,35,54,33],[58,39,54,37],[58,40,54,38],[58,44,54,42],[58,55,54,53],[58,56,54,54,"test"],[58,60,54,58],[58,61,54,59,"potentialCode"],[58,74,54,72],[58,75,54,73],[58,77,54,75],[59,8,55,6],[59,15,55,13],[60,10,56,8,"code"],[60,14,56,12],[60,16,56,14,"potentialCode"],[60,29,56,27],[61,10,57,8,"message"],[61,17,57,15],[61,19,57,17,"errorString"],[61,30,57,28],[61,31,57,29,"substring"],[61,40,57,38],[61,41,57,39,"colonIndex"],[61,51,57,49],[61,54,57,52],[61,55,57,53],[61,56,57,54],[61,57,57,55,"trim"],[61,61,57,59],[61,62,57,60],[62,8,58,6],[62,9,58,7],[63,6,59,4],[64,4,60,2],[66,4,62,2],[67,4,63,2],[67,11,63,9],[68,6,64,4,"code"],[68,10,64,8],[68,12,64,10,"ErrorCode"],[68,20,64,19],[68,21,64,19,"ErrorCode"],[68,30,64,19],[68,31,64,20,"Unknown"],[68,38,64,27],[69,6,65,4,"message"],[69,13,65,11],[69,15,65,13,"errorString"],[70,4,66,2],[70,5,66,3],[71,2,67,0],[73,2,69,0],[74,0,70,0],[75,0,71,0],[76,0,72,0],[77,0,73,0],[78,2,74,7],[78,11,74,16,"isUserCancelledError"],[78,31,74,36,"isUserCancelledError"],[78,32,74,37,"error"],[78,37,74,42],[78,39,74,44],[79,4,75,2],[79,10,75,8,"errorObj"],[79,18,75,16],[79,21,75,19],[79,28,75,26,"error"],[79,33,75,31],[79,38,75,36],[79,46,75,44],[79,50,75,48,"error"],[79,55,75,53],[79,60,75,58],[79,64,75,62],[79,68,75,66],[79,74,75,72],[79,78,75,76,"error"],[79,83,75,81],[79,86,75,84,"error"],[79,91,75,89],[79,94,75,92,"parseErrorStringToJsonObj"],[79,119,75,117],[79,120,75,118,"error"],[79,125,75,123],[79,126,75,124],[80,4,76,2],[80,11,76,9,"errorObj"],[80,19,76,17],[80,20,76,18,"code"],[80,24,76,22],[80,29,76,27,"ErrorCode"],[80,37,76,36],[80,38,76,36,"ErrorCode"],[80,47,76,36],[80,48,76,37,"UserCancelled"],[80,61,76,50],[80,65,76,54,"errorObj"],[80,73,76,62],[80,74,76,63,"code"],[80,78,76,67],[80,83,76,72],[80,100,76,89],[81,4,77,2],[82,4,78,2,"errorObj"],[82,12,78,10],[82,13,78,11,"responseCode"],[82,25,78,23],[82,30,78,28],[82,31,78,29],[82,32,78,30],[82,33,78,31],[83,2,79,0],[84,0,79,1],[84,3]],"functionMap":{"names":["<global>","parseErrorStringToJsonObj","isUserCancelledError"],"mappings":"AAA;OCkB;CDgD;OEO;CFK"},"hasCjsExports":false},"type":"js/module"}]}