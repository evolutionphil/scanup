{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":49,"index":83}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":125},"end":{"line":4,"column":69,"index":194}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"useAuthStore\",{enumerable:!0,get:function(){return h}});var t=r(_d[0]);!(function(t){if(t&&t.__esModule)return t;var e={};t&&Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),e.default=t})(r(_d[1]));r(_d[2]);var e,s=r(_d[3]),n=(e=s)&&e.__esModule?e:{default:e};const o=process.env.EXPO_PUBLIC_BACKEND_URL,u=async t=>n.default.getItem(t),c=async(t,e)=>{await n.default.setItem(t,e)},d=async t=>{await n.default.removeItem(t)},l={user_id:'guest',email:'guest@local',name:'Guest',subscription_type:'free',is_premium:!1,ocr_remaining_today:3,scans_remaining_today:10,scans_remaining_month:100},h=(0,t.create)((t,e)=>({user:null,token:null,isLoading:!0,isAuthenticated:!1,isGuest:!1,login:async(e,s)=>{const n=await fetch(`${o}/api/auth/login`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:e,password:s})});if(!n.ok){const t=await n.json();throw new Error(t.detail||'Login failed')}const u=await n.json();await c('token',u.token),await c('user',JSON.stringify(u.user)),t({user:u.user,token:u.token,isAuthenticated:!0,isGuest:!1})},register:async(e,s,n)=>{const u=await fetch(`${o}/api/auth/register`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:e,password:s,name:n})});if(!u.ok){const t=await u.json();throw new Error(t.detail||'Registration failed')}const d=await u.json();await c('token',d.token),await c('user',JSON.stringify(d.user)),t({user:d.user,token:d.token,isAuthenticated:!0,isGuest:!1})},googleLogin:async e=>{const s=await fetch(`${o}/api/auth/google/callback`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({session_id:e})});if(!s.ok){const t=await s.json();throw new Error(t.detail||'Google login failed')}const n=await s.json();await c('token',n.token),await c('user',JSON.stringify(n.user)),t({user:n.user,token:n.token,isAuthenticated:!0,isGuest:!1})},logout:async()=>{const s=e().token,n=e().isGuest;if(t({user:null,token:null,isAuthenticated:!1,isGuest:!1,isLoading:!1}),await d('token'),await d('user'),await d('isGuest'),s&&!n)try{fetch(`${o}/api/auth/logout`,{method:'POST',headers:{Authorization:`Bearer ${s}`}}).catch(()=>{})}catch(t){}},loadStoredAuth:async()=>{try{if('true'===await u('isGuest'))return void t({user:l,isAuthenticated:!0,isGuest:!0,isLoading:!1});const s=await u('token'),n=await u('user');if(s&&n){const o=JSON.parse(n);t({user:o,token:s,isAuthenticated:!0,isLoading:!1}),e().refreshUser()}else t({isLoading:!1})}catch(e){console.log('Error loading auth:',e),t({isLoading:!1})}},updateUser:e=>{t({user:e}),c('user',JSON.stringify(e))},refreshUser:async()=>{const s=e().token;if(s&&!e().isGuest)try{const n=await fetch(`${o}/api/auth/me`,{headers:{Authorization:`Bearer ${s}`}});if(n.ok){const e=await n.json();t({user:e}),await c('user',JSON.stringify(e))}else 401===n.status&&await e().logout()}catch(t){console.log('Error refreshing user:',t)}},continueAsGuest:()=>{t({user:l,isAuthenticated:!0,isGuest:!0,isLoading:!1}),c('isGuest','true')},startTrial:async()=>{const s=e().token;if(!s||e().isGuest)return;const n=await fetch(`${o}/api/users/start-trial`,{method:'POST',headers:{Authorization:`Bearer ${s}`}});if(!n.ok){const t=await n.json();throw new Error(t.detail||'Failed to start trial')}const u=await n.json();t({user:u}),await c('user',JSON.stringify(u))}}))});","lineCount":1,"map":[[1,93,73,0,"Object"],[1,100,73,0,"defineProperty"],[1,115,73,0,"_e"],[1,118,73,0],[1,134,73,0,"enumerable"],[1,146,73,0],[1,148,73,0,"get"],[1,152,73,0],[1,170,73,0,"useAuthStore"],[1,171,73,0],[1,175,1,0],[1,179,1,0,"_zustand"],[1,181,1,0,"r"],[1,183,1,0,"_d"],[1,186,1,0],[1,192],[1,416,2,0,"_interopNamespace"],[1,417,2,0,"r"],[1,419,2,0,"_d"],[1,422,2,0],[1,427,2,49,"r"],[1,429,2,49,"_d"],[1,432,2,49],[1,436,4,0],[1,440],[1,442,4,0,"_reactNativeAsyncStorageAsyncStorage"],[1,444,4,0,"r"],[1,446,4,0,"_d"],[1,449,4,0],[1,453,4,0,"AsyncStorage"],[1,456],[1,458,4,0,"_reactNativeAsyncStorageAsyncStorage"],[1,462],[1,489,6,0],[1,495,6,6,"BACKEND_URL"],[1,497,6,20,"process"],[1,505,6,28,"env"],[1,509,6,32,"EXPO_PUBLIC_BACKEND_URL"],[1,533,39,6,"getStorage"],[1,535,39,19,"async"],[1,544,41,11,"AsyncStorage"],[1,546,41,23,"default"],[1,554,41,24,"getItem"],[1,562,41,32,"key"],[1,565,46,6,"setStorage"],[1,567,46,19,"async"],[1,573,46,26,"key"],[1,575,46,39,"value"],[1,586,48,10,"AsyncStorage"],[1,588,48,22,"default"],[1,596,48,23,"setItem"],[1,604,48,31,"key"],[1,606,48,36,"value"],[1,610,54,6,"removeStorage"],[1,612,54,22,"async"],[1,628,56,10,"AsyncStorage"],[1,630,56,22,"default"],[1,638,56,23,"removeItem"],[1,649,56,34,"key"],[1,653,62,6,"guestUser"],[1,655,62,24],[1,656,63,2,"user_id"],[1,664,63,11],[1,672,64,2,"email"],[1,678,64,9],[1,692,65,2,"name"],[1,697,65,8],[1,705,66,2,"subscription_type"],[1,723,66,21],[1,730,67,2,"is_premium"],[1,742,67,14],[1,744,68,2,"ocr_remaining_today"],[1,764,68,23],[1,766,69,2,"scans_remaining_today"],[1,788,69,25],[1,791,70,2,"scans_remaining_month"],[1,813,70,25],[1,818,73,13,"useAuthStore"],[1,821,73,28],[1,823,73,28,"create"],[1,825,73,34,"create"],[1,833,73,46],[1,834,73,47,"set"],[1,836,73,52,"get"],[1,841,73,55],[1,842,74,2,"user"],[1,847,74,8],[1,852,75,2,"token"],[1,858,75,9],[1,863,76,2,"isLoading"],[1,874,76,13],[1,876,77,2,"isAuthenticated"],[1,893,77,19],[1,895,78,2,"isGuest"],[1,904,78,11],[1,906,80,2,"login"],[1,912,80,9,"async"],[1,918,80,16,"email"],[1,920,80,31,"password"],[1,925,81,4],[1,931,81,10,"response"],[1,939,81,27,"fetch"],[1,945,81,33],[1,948,81,36,"BACKEND_URL"],[1,967,81,66],[1,968,82,6,"method"],[1,975,82,14],[1,982,83,6,"headers"],[1,990,83,15],[1,991,83,17],[1,1006,83,33],[1,1026,84,6,"body"],[1,1031,84,12,"JSON"],[1,1036,84,17,"stringify"],[1,1046,84,27],[1,1047,84,29,"email"],[1,1055,84,36,"password"],[1,1070,87,4],[1,1074,87,9,"response"],[1,1076,87,18,"ok"],[1,1079,87,22],[1,1080,88,6],[1,1086,88,12,"error"],[1,1094,88,26,"response"],[1,1096,88,35,"json"],[1,1103,89,6],[1,1109,89,12],[1,1113,89,16,"Error"],[1,1119,89,22,"error"],[1,1121,89,28,"detail"],[1,1129,89,38],[1,1144,90,4],[1,1145,92,4],[1,1151,92,10,"data"],[1,1159,92,23,"response"],[1,1161,92,32,"json"],[1,1174,93,10,"setStorage"],[1,1176,93,21],[1,1184,93,30,"data"],[1,1186,93,35,"token"],[1,1199,94,10,"setStorage"],[1,1201,94,21],[1,1208,94,29,"JSON"],[1,1213,94,34,"stringify"],[1,1223,94,44,"data"],[1,1225,94,49,"user"],[1,1232,95,4,"set"],[1,1234,95,8],[1,1235,95,10,"user"],[1,1240,95,16,"data"],[1,1242,95,21,"user"],[1,1247,95,27,"token"],[1,1253,95,34,"data"],[1,1255,95,39,"token"],[1,1261,95,46,"isAuthenticated"],[1,1278,95,63],[1,1280,95,69,"isGuest"],[1,1289,95,78],[1,1294,98,2,"register"],[1,1303,98,12,"async"],[1,1309,98,19,"email"],[1,1311,98,34,"password"],[1,1313,98,52,"name"],[1,1318,99,4],[1,1324,99,10,"response"],[1,1332,99,27,"fetch"],[1,1338,99,33],[1,1341,99,36,"BACKEND_URL"],[1,1363,99,69],[1,1364,100,6,"method"],[1,1371,100,14],[1,1378,101,6,"headers"],[1,1386,101,15],[1,1387,101,17],[1,1402,101,33],[1,1422,102,6,"body"],[1,1427,102,12,"JSON"],[1,1432,102,17,"stringify"],[1,1442,102,27],[1,1443,102,29,"email"],[1,1451,102,36,"password"],[1,1462,102,46,"name"],[1,1473,105,4],[1,1477,105,9,"response"],[1,1479,105,18,"ok"],[1,1482,105,22],[1,1483,106,6],[1,1489,106,12,"error"],[1,1497,106,26,"response"],[1,1499,106,35,"json"],[1,1506,107,6],[1,1512,107,12],[1,1516,107,16,"Error"],[1,1522,107,22,"error"],[1,1524,107,28,"detail"],[1,1532,107,38],[1,1554,108,4],[1,1555,110,4],[1,1561,110,10,"data"],[1,1569,110,23,"response"],[1,1571,110,32,"json"],[1,1584,111,10,"setStorage"],[1,1586,111,21],[1,1594,111,30,"data"],[1,1596,111,35,"token"],[1,1609,112,10,"setStorage"],[1,1611,112,21],[1,1618,112,29,"JSON"],[1,1623,112,34,"stringify"],[1,1633,112,44,"data"],[1,1635,112,49,"user"],[1,1642,113,4,"set"],[1,1644,113,8],[1,1645,113,10,"user"],[1,1650,113,16,"data"],[1,1652,113,21,"user"],[1,1657,113,27,"token"],[1,1663,113,34,"data"],[1,1665,113,39,"token"],[1,1671,113,46,"isAuthenticated"],[1,1688,113,63],[1,1690,113,69,"isGuest"],[1,1699,113,78],[1,1704,116,2,"googleLogin"],[1,1716,116,15,"async"],[1,1726,117,4],[1,1732,117,10,"response"],[1,1740,117,27,"fetch"],[1,1746,117,33],[1,1749,117,36,"BACKEND_URL"],[1,1778,117,76],[1,1779,118,6,"method"],[1,1786,118,14],[1,1793,119,6,"headers"],[1,1801,119,15],[1,1802,119,17],[1,1817,119,33],[1,1837,120,6,"body"],[1,1842,120,12,"JSON"],[1,1847,120,17,"stringify"],[1,1857,120,27],[1,1858,120,29,"session_id"],[1,1869,120,41,"sessionId"],[1,1875,123,4],[1,1879,123,9,"response"],[1,1881,123,18,"ok"],[1,1884,123,22],[1,1885,124,6],[1,1891,124,12,"error"],[1,1899,124,26,"response"],[1,1901,124,35,"json"],[1,1908,125,6],[1,1914,125,12],[1,1918,125,16,"Error"],[1,1924,125,22,"error"],[1,1926,125,28,"detail"],[1,1934,125,38],[1,1956,126,4],[1,1957,128,4],[1,1963,128,10,"data"],[1,1971,128,23,"response"],[1,1973,128,32,"json"],[1,1986,129,10,"setStorage"],[1,1988,129,21],[1,1996,129,30,"data"],[1,1998,129,35,"token"],[1,2011,130,10,"setStorage"],[1,2013,130,21],[1,2020,130,29,"JSON"],[1,2025,130,34,"stringify"],[1,2035,130,44,"data"],[1,2037,130,49,"user"],[1,2044,131,4,"set"],[1,2046,131,8],[1,2047,131,10,"user"],[1,2052,131,16,"data"],[1,2054,131,21,"user"],[1,2059,131,27,"token"],[1,2065,131,34,"data"],[1,2067,131,39,"token"],[1,2073,131,46,"isAuthenticated"],[1,2090,131,63],[1,2092,131,69,"isGuest"],[1,2101,131,78],[1,2106,134,2,"logout"],[1,2113,134,10,"async"],[1,2123,135,4],[1,2129,135,10,"token"],[1,2131,135,18,"get"],[1,2135,135,24,"token"],[1,2141,136,10,"wasGuest"],[1,2143,136,21,"get"],[1,2147,136,27,"isGuest"],[1,2155,147,4],[1,2158,139,4,"set"],[1,2160,139,8],[1,2161,139,10,"user"],[1,2166,139,16],[1,2171,139,22,"token"],[1,2177,139,29],[1,2182,139,35,"isAuthenticated"],[1,2199,139,52],[1,2201,139,59,"isGuest"],[1,2210,139,68],[1,2212,139,75,"isLoading"],[1,2223,139,86],[1,2233,142,10,"removeStorage"],[1,2235,142,24],[1,2250,143,10,"removeStorage"],[1,2252,143,24],[1,2266,144,10,"removeStorage"],[1,2268,144,24],[1,2279,147,8,"token"],[1,2283,147,18,"wasGuest"],[1,2285,148,6],[1,2289,149,8,"fetch"],[1,2295,149,14],[1,2298,149,17,"BACKEND_URL"],[1,2318,149,48],[1,2319,150,10,"method"],[1,2326,150,18],[1,2333,151,10,"headers"],[1,2341,151,19],[1,2342,151,21,"Authorization"],[1,2356,151,36],[1,2366,151,46,"token"],[1,2373,152,11,"catch"],[1,2379,152,17],[1,2386,153,6],[1,2387,153,8],[1,2393,153,15,"e"],[1,2396,154,8],[1,2399,159,2,"loadStoredAuth"],[1,2414,159,18,"async"],[1,2424,160,4],[1,2428,162,6],[1,2431,162,28],[1,2446,161,34,"getStorage"],[1,2448,161,45],[1,2459,164,8],[1,2471,163,8,"set"],[1,2473,163,12],[1,2474,163,14,"user"],[1,2479,163,20,"guestUser"],[1,2481,163,31,"isAuthenticated"],[1,2498,163,48],[1,2500,163,54,"isGuest"],[1,2509,163,63],[1,2511,163,69,"isLoading"],[1,2522,163,80],[1,2526,167,6],[1,2532,167,12,"token"],[1,2540,167,26,"getStorage"],[1,2542,167,37],[1,2551,168,12,"userStr"],[1,2559,168,28,"getStorage"],[1,2561,168,39],[1,2569,170,6],[1,2572,170,10,"token"],[1,2575,170,19,"userStr"],[1,2577,170,28],[1,2578,171,8],[1,2584,171,14,"user"],[1,2586,171,21,"JSON"],[1,2591,171,26,"parse"],[1,2597,171,32,"userStr"],[1,2600,172,8,"set"],[1,2602,172,12],[1,2603,172,14,"user"],[1,2610,172,20,"token"],[1,2618,172,27,"isAuthenticated"],[1,2635,172,44],[1,2637,172,50,"isLoading"],[1,2648,172,61],[1,2652,173,8,"get"],[1,2656,173,14,"refreshUser"],[1,2669,174,6],[1,2675,175,8,"set"],[1,2677,175,12],[1,2678,175,14,"isLoading"],[1,2689,175,25],[1,2692,177,4],[1,2693,177,6],[1,2699,177,13,"e"],[1,2702,178,6,"console"],[1,2710,178,14,"log"],[1,2714,178,18],[1,2736,178,41,"e"],[1,2739,179,6,"set"],[1,2741,179,10],[1,2742,179,12,"isLoading"],[1,2753,179,23],[1,2756,180,4],[1,2759,183,2,"updateUser"],[1,2770,183,15,"user"],[1,2774,184,4,"set"],[1,2776,184,8],[1,2777,184,10,"user"],[1,2786,185,4,"setStorage"],[1,2788,185,15],[1,2795,185,23,"JSON"],[1,2800,185,28,"stringify"],[1,2810,185,38,"user"],[1,2815,188,2,"refreshUser"],[1,2827,188,15,"async"],[1,2837,189,4],[1,2843,189,10,"token"],[1,2845,189,18,"get"],[1,2849,189,24,"token"],[1,2855,190,4],[1,2858,190,9,"token"],[1,2862,190,18,"get"],[1,2866,190,24,"isGuest"],[1,2874,192,4],[1,2878,193,6],[1,2884,193,12,"response"],[1,2892,193,29,"fetch"],[1,2898,193,35],[1,2901,193,38,"BACKEND_URL"],[1,2917,193,65],[1,2918,194,8,"headers"],[1,2926,194,17],[1,2927,194,19,"Authorization"],[1,2941,194,34],[1,2951,194,44,"token"],[1,2958,197,6],[1,2961,197,10,"response"],[1,2963,197,19,"ok"],[1,2966,197,23],[1,2967,198,8],[1,2973,198,14,"user"],[1,2981,198,27,"response"],[1,2983,198,36,"json"],[1,2990,199,8,"set"],[1,2992,199,12],[1,2993,199,14,"user"],[1,3008,200,14,"setStorage"],[1,3010,200,25],[1,3017,200,33,"JSON"],[1,3022,200,38,"stringify"],[1,3032,200,48,"user"],[1,3035,201,6],[1,3041,201,37],[1,3047,201,17,"response"],[1,3049,201,26,"status"],[1,3063,202,14,"get"],[1,3067,202,20,"logout"],[1,3075,204,4],[1,3076,204,6],[1,3082,204,13,"e"],[1,3085,205,6,"console"],[1,3093,205,14,"log"],[1,3097,205,18],[1,3122,205,44,"e"],[1,3124,206,4],[1,3127,209,2,"continueAsGuest"],[1,3143,209,19,"continueAsGuest"],[1,3148,210,4,"set"],[1,3150,210,8],[1,3151,210,10,"user"],[1,3156,210,16,"guestUser"],[1,3158,210,27,"isAuthenticated"],[1,3175,210,44],[1,3177,210,50,"isGuest"],[1,3186,210,59],[1,3188,210,65,"isLoading"],[1,3199,210,76],[1,3203,211,4,"setStorage"],[1,3205,211,15],[1,3215,211,26],[1,3224,214,2,"startTrial"],[1,3235,214,14,"async"],[1,3245,215,4],[1,3251,215,10,"token"],[1,3253,215,18,"get"],[1,3257,215,24,"token"],[1,3263,216,4],[1,3267,216,9,"token"],[1,3270,216,18,"get"],[1,3274,216,24,"isGuest"],[1,3282,216,33],[1,3289,218,4],[1,3295,218,10,"response"],[1,3303,218,27,"fetch"],[1,3309,218,33],[1,3312,218,36,"BACKEND_URL"],[1,3338,218,73],[1,3339,219,6,"method"],[1,3346,219,14],[1,3353,220,6,"headers"],[1,3361,220,15],[1,3362,220,17,"Authorization"],[1,3376,220,32],[1,3386,220,42,"token"],[1,3393,223,4],[1,3397,223,9,"response"],[1,3399,223,18,"ok"],[1,3402,223,22],[1,3403,224,6],[1,3409,224,12,"error"],[1,3417,224,26,"response"],[1,3419,224,35,"json"],[1,3426,225,6],[1,3432,225,12],[1,3436,225,16,"Error"],[1,3442,225,22,"error"],[1,3444,225,28,"detail"],[1,3452,225,38],[1,3476,226,4],[1,3477,228,4],[1,3483,228,10,"user"],[1,3491,228,23,"response"],[1,3493,228,32,"json"],[1,3500,229,4,"set"],[1,3502,229,8],[1,3503,229,10,"user"],[1,3518,230,10,"setStorage"],[1,3520,230,21],[1,3527,230,29,"JSON"],[1,3532,230,34,"stringify"],[1,3542,230,44,"user"],[1,3549,232,4],[1,3552]],"functionMap":{"names":["<global>","getStorage","setStorage","removeStorage","create$argument_0","login","register","googleLogin","logout","fetch._catch$argument_0","loadStoredAuth","updateUser","refreshUser","continueAsGuest","startTrial"],"mappings":"AAA;mBCsC;CDK;mBEE;CFM;sBGE;CHM;8CIa;SCO;GDgB;YEE;GFgB;eGE;GHgB;UIE;iBCkB,QD;GJK;kBME;GNsB;cOE;GPG;eQE;GRmB;mBSE;GTG;cUE;GViB;EJC"},"hasCjsExports":false},"type":"js/module"}]}