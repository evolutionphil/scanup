{"dependencies":[{"name":"./DecodeStream.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":252},"end":{"line":8,"column":45,"index":297}}],"key":"C/oJ0k7XQ3jAGDeWWv3yHXara3I=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _DecodeStreamJs = require(_dependencyMap[0], \"./DecodeStream.js\");\n  var DecodeStream = _interopDefault(_DecodeStreamJs);\n  /*\n   * Copyright 2012 Mozilla Foundation\n   *\n   * The RunLengthStream class contained in this file is a TypeScript port of the\n   * JavaScript RunLengthStream class in Mozilla's pdf.js project, made available\n   * under the Apache 2.0 open source license.\n   */\n\n  class RunLengthStream extends DecodeStream.default {\n    constructor(stream, maybeLength) {\n      super(maybeLength);\n      this.stream = stream;\n    }\n    readBlock() {\n      // The repeatHeader has following format. The first byte defines type of run\n      // and amount of bytes to repeat/copy: n = 0 through 127 - copy next n bytes\n      // (in addition to the second byte from the header), n = 129 through 255 -\n      // duplicate the second byte from the header (257 - n) times, n = 128 - end.\n      const repeatHeader = this.stream.getBytes(2);\n      if (!repeatHeader || repeatHeader.length < 2 || repeatHeader[0] === 128) {\n        this.eof = true;\n        return;\n      }\n      let buffer;\n      let bufferLength = this.bufferLength;\n      let n = repeatHeader[0];\n      if (n < 128) {\n        // copy n bytes\n        buffer = this.ensureBuffer(bufferLength + n + 1);\n        buffer[bufferLength++] = repeatHeader[1];\n        if (n > 0) {\n          const source = this.stream.getBytes(n);\n          buffer.set(source, bufferLength);\n          bufferLength += n;\n        }\n      } else {\n        n = 257 - n;\n        const b = repeatHeader[1];\n        buffer = this.ensureBuffer(bufferLength + n + 1);\n        for (let i = 0; i < n; i++) {\n          buffer[bufferLength++] = b;\n        }\n      }\n      this.bufferLength = bufferLength;\n    }\n  }\n  var _default = RunLengthStream;\n});","lineCount":67,"map":[[12,2,48,0,"Object"],[12,8,48,0],[12,9,48,0,"defineProperty"],[12,23,48,0],[12,24,48,0,"exports"],[12,31,48,0],[13,4,48,0,"enumerable"],[13,14,48,0],[14,4,48,0,"get"],[14,7,48,0],[14,18,48,0,"get"],[14,19,48,0],[15,6,48,0],[15,13,48,0,"_default"],[15,21,48,0],[16,4,48,0],[17,2,48,0],[18,2,8,0],[18,6,8,0,"_DecodeStreamJs"],[18,21,8,0],[18,24,8,0,"require"],[18,31,8,0],[18,32,8,0,"_dependencyMap"],[18,46,8,0],[19,2,8,0],[19,6,8,0,"DecodeStream"],[19,18,8,0],[19,21,8,0,"_interopDefault"],[19,36,8,0],[19,37,8,0,"_DecodeStreamJs"],[19,52,8,0],[20,2,1,0],[21,0,2,0],[22,0,3,0],[23,0,4,0],[24,0,5,0],[25,0,6,0],[26,0,7,0],[28,2,9,0],[28,8,9,6,"RunLengthStream"],[28,23,9,21],[28,32,9,30,"DecodeStream"],[28,44,9,42],[28,45,9,42,"default"],[28,52,9,42],[28,53,9,43],[29,4,10,4,"constructor"],[29,15,10,15,"constructor"],[29,16,10,16,"stream"],[29,22,10,22],[29,24,10,24,"maybeLength"],[29,35,10,35],[29,37,10,37],[30,6,11,8],[30,11,11,13],[30,12,11,14,"maybeLength"],[30,23,11,25],[30,24,11,26],[31,6,12,8],[31,10,12,12],[31,11,12,13,"stream"],[31,17,12,19],[31,20,12,22,"stream"],[31,26,12,28],[32,4,13,4],[33,4,14,4,"readBlock"],[33,13,14,13,"readBlock"],[33,14,14,13],[33,16,14,16],[34,6,15,8],[35,6,16,8],[36,6,17,8],[37,6,18,8],[38,6,19,8],[38,12,19,14,"repeatHeader"],[38,24,19,26],[38,27,19,29],[38,31,19,33],[38,32,19,34,"stream"],[38,38,19,40],[38,39,19,41,"getBytes"],[38,47,19,49],[38,48,19,50],[38,49,19,51],[38,50,19,52],[39,6,20,8],[39,10,20,12],[39,11,20,13,"repeatHeader"],[39,23,20,25],[39,27,20,29,"repeatHeader"],[39,39,20,41],[39,40,20,42,"length"],[39,46,20,48],[39,49,20,51],[39,50,20,52],[39,54,20,56,"repeatHeader"],[39,66,20,68],[39,67,20,69],[39,68,20,70],[39,69,20,71],[39,74,20,76],[39,77,20,79],[39,79,20,81],[40,8,21,12],[40,12,21,16],[40,13,21,17,"eof"],[40,16,21,20],[40,19,21,23],[40,23,21,27],[41,8,22,12],[42,6,23,8],[43,6,24,8],[43,10,24,12,"buffer"],[43,16,24,18],[44,6,25,8],[44,10,25,12,"bufferLength"],[44,22,25,24],[44,25,25,27],[44,29,25,31],[44,30,25,32,"bufferLength"],[44,42,25,44],[45,6,26,8],[45,10,26,12,"n"],[45,11,26,13],[45,14,26,16,"repeatHeader"],[45,26,26,28],[45,27,26,29],[45,28,26,30],[45,29,26,31],[46,6,27,8],[46,10,27,12,"n"],[46,11,27,13],[46,14,27,16],[46,17,27,19],[46,19,27,21],[47,8,28,12],[48,8,29,12,"buffer"],[48,14,29,18],[48,17,29,21],[48,21,29,25],[48,22,29,26,"ensureBuffer"],[48,34,29,38],[48,35,29,39,"bufferLength"],[48,47,29,51],[48,50,29,54,"n"],[48,51,29,55],[48,54,29,58],[48,55,29,59],[48,56,29,60],[49,8,30,12,"buffer"],[49,14,30,18],[49,15,30,19,"bufferLength"],[49,27,30,31],[49,29,30,33],[49,30,30,34],[49,33,30,37,"repeatHeader"],[49,45,30,49],[49,46,30,50],[49,47,30,51],[49,48,30,52],[50,8,31,12],[50,12,31,16,"n"],[50,13,31,17],[50,16,31,20],[50,17,31,21],[50,19,31,23],[51,10,32,16],[51,16,32,22,"source"],[51,22,32,28],[51,25,32,31],[51,29,32,35],[51,30,32,36,"stream"],[51,36,32,42],[51,37,32,43,"getBytes"],[51,45,32,51],[51,46,32,52,"n"],[51,47,32,53],[51,48,32,54],[52,10,33,16,"buffer"],[52,16,33,22],[52,17,33,23,"set"],[52,20,33,26],[52,21,33,27,"source"],[52,27,33,33],[52,29,33,35,"bufferLength"],[52,41,33,47],[52,42,33,48],[53,10,34,16,"bufferLength"],[53,22,34,28],[53,26,34,32,"n"],[53,27,34,33],[54,8,35,12],[55,6,36,8],[55,7,36,9],[55,13,37,13],[56,8,38,12,"n"],[56,9,38,13],[56,12,38,16],[56,15,38,19],[56,18,38,22,"n"],[56,19,38,23],[57,8,39,12],[57,14,39,18,"b"],[57,15,39,19],[57,18,39,22,"repeatHeader"],[57,30,39,34],[57,31,39,35],[57,32,39,36],[57,33,39,37],[58,8,40,12,"buffer"],[58,14,40,18],[58,17,40,21],[58,21,40,25],[58,22,40,26,"ensureBuffer"],[58,34,40,38],[58,35,40,39,"bufferLength"],[58,47,40,51],[58,50,40,54,"n"],[58,51,40,55],[58,54,40,58],[58,55,40,59],[58,56,40,60],[59,8,41,12],[59,13,41,17],[59,17,41,21,"i"],[59,18,41,22],[59,21,41,25],[59,22,41,26],[59,24,41,28,"i"],[59,25,41,29],[59,28,41,32,"n"],[59,29,41,33],[59,31,41,35,"i"],[59,32,41,36],[59,34,41,38],[59,36,41,40],[60,10,42,16,"buffer"],[60,16,42,22],[60,17,42,23,"bufferLength"],[60,29,42,35],[60,31,42,37],[60,32,42,38],[60,35,42,41,"b"],[60,36,42,42],[61,8,43,12],[62,6,44,8],[63,6,45,8],[63,10,45,12],[63,11,45,13,"bufferLength"],[63,23,45,25],[63,26,45,28,"bufferLength"],[63,38,45,40],[64,4,46,4],[65,2,47,0],[66,2,48,0],[66,6,48,0,"_default"],[66,14,48,0],[66,17,48,15,"RunLengthStream"],[66,32,48,30],[67,0,48,31],[67,3]],"functionMap":{"names":["<global>","RunLengthStream","constructor","readBlock"],"mappings":"AAA;ACQ;ICC;KDG;IEC;KFgC;CDC"},"hasCjsExports":false},"type":"js/module"}]}